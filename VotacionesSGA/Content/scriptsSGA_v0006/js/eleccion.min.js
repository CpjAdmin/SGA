function obtenerPapeletas(){$.ajax({type:"POST",url:apiUrl+"/api/Asamblea/PapeletaRonda/ListadoPapeletas",contentType:"application/json; charset=utf-8",error:function(n,t,i){mensajeError=n.status+"\n"+n.responseText;"\n"+i;alertaError("Carga papeletas",mensajeError)},success:function(n){CargarComboPapeletas(n)}})}function CargarComboPapeletas(n){$("#selPapeleta").empty();n.map(function(n){$("#selPapeleta").append('<option value="'+n.Id_papeleta+'">'+n.Nombre+"<\/option>")})}function CargarTablaElecciones(){CargarFilasR();CargarFilasPR();pidEleccion="";pNombreEleccion="";pidEleccionR="";PNombreEleccionR="";pidPapeletaC="";$("#tituloRondaE").text("Rondas por Elecciones");$("#tituloPapeletaR").text("Papeletas por ronda");MostrarCargando();$.ajax({type:"POST",url:apiUrl+"/api/Asamblea/Eleccion/ListadoElecciones",contentType:"application/json; charset=utf-8",dataType:"JSON",error:function(n,t,i){mensajeError=n.status+"\n"+n.responseText;"\n"+i;alertaError("Listado elecciones",mensajeError);CerrarCargando()},success:function(n){CargarFilas(n);CerrarCargando()}})}function CargarFilas(n){var t=[];n.map(function(n){t.push([n.Id_eleccion,n.Nombre,n.Descripcion,n.F_inicio,n.F_final,n.I_estado=="A"?"Activo":"Inactivo",n.I_cierre_quorum=="S"?"Si":"No",'<img class="tooltipImgM" src="images/Iconos/update.png" style="cursor:pointer" data-toggle="tooltip" title="Modificar" />','<img class="tooltipImgB" src="images/Iconos/delete.png" style="cursor:pointer" data-toggle="tooltip" title="Eliminar" />'])});tablaE=objtablaE.DataTable({data:t,columns:[null,null,null,null,null,null,null,{width:"5%",sortable:!1,className:"textoCentrado"},{width:"5%",sortable:!1,className:"textoCentrado"}],paging:!0,lengthChange:!1,searching:!0,ordering:!0,info:!0,pageLength:20,autoWidth:!1,destroy:!0,deferRender:!0,scrollCollapse:!0,scroller:!0});tablaE.draw();$("#tablaEleccion tbody").on("click","tr",function(){$(this).hasClass("selected")||(tablaE.$("tr.selected").removeClass("selected"),$(this).addClass("selected"))})}function GuardarEleccion(){MostrarCargando();DatosE.Nombre=$("#nombre").val();DatosE.Descripcion=$("#descripcion").val();DatosE.F_inicio=$("#dtpRango").data("daterangepicker").startDate.format("DD/MM/YYYY hh:mm A").toString();DatosE.F_final=$("#dtpRango").data("daterangepicker").endDate.format("DD/MM/YYYY hh:mm A").toString();DatosE.Usuario=sessionStorage.Cedula;DatosE.I_estado=$("#chkactivo").is(":checked")?"A":"I";DatosE.I_cierre_quorum=$("#chkquorum").is(":checked")?"S":"N";$.ajax({type:"POST",url:apiUrl+"/api/Asamblea/Eleccion/InsertarEleccion",data:JSON.stringify(DatosE),contentType:"application/json; charset=utf-8",dataType:"JSON",headers:{Auth:sessionStorage.Cedula+":"+sessionStorage.Token},error:function(n,t,i){mensajeError=n.status+"\n"+n.responseText;"\n"+i;alertaError("Guardar datos",mensajeError);CerrarCargando()},success:function(n){n.Error=="0"?(alertaExito("Guardar datos","Datos Guardados correctamente"),CargarTablaElecciones(),CerrarCargando()):(alertaError("Guardar datos",n.Mensaje),CerrarCargando())}})}function ModificarEleccion(){MostrarCargando();DatosE.Id_eleccion=$("#id").val();DatosE.Nombre=$("#nombre").val();DatosE.Descripcion=$("#descripcion").val();DatosE.F_inicio=$("#dtpRango").data("daterangepicker").startDate.format("DD/MM/YYYY hh:mm A").toString();DatosE.F_final=$("#dtpRango").data("daterangepicker").endDate.format("DD/MM/YYYY hh:mm A").toString();DatosE.Usuario=sessionStorage.Cedula;DatosE.I_estado=$("#chkactivo").is(":checked")?"A":"I";DatosE.I_cierre_quorum=$("#chkquorum").is(":checked")?"S":"N";$.ajax({type:"POST",url:apiUrl+"/api/Asamblea/Eleccion/ActualizarEleccion",data:JSON.stringify(DatosE),contentType:"application/json; charset=utf-8",dataType:"JSON",headers:{Auth:sessionStorage.Cedula+":"+sessionStorage.Token},error:function(n,t,i){mensajeError=n.status+"\n"+n.responseText;"\n"+i;alertaError("Guardar datos",mensajeError);CerrarCargando()},success:function(n){n.Error=="0"?(alertaExito("Guardar datos","Datos Modificados correctamente"),CargarTablaElecciones(),CerrarCargando()):(alertaError("Guardar datos",n.Mensaje),CerrarCargando())}})}function EliminarEleccion(n){MostrarCargando();DatosE.Id_eleccion=n;DatosE.Nombre="";DatosE.Descripcion="";DatosE.F_inicio="";DatosE.F_final="";DatosE.User_modifica="";DatosE.I_estado="";DatosE.I_cierre_quorum="";$.ajax({type:"POST",url:apiUrl+"/api/Asamblea/Eleccion/EliminarEleccion",data:JSON.stringify(DatosE),contentType:"application/json; charset=utf-8",dataType:"JSON",headers:{Auth:sessionStorage.Cedula+":"+sessionStorage.Token},error:function(n,t,i){mensajeError=n.status+"\n"+n.responseText;"\n"+i;alertaError("Guardar datos",mensajeError);CerrarCargando()},success:function(n){n.Error=="0"?(alertaExito("Eliminar datos","Datos Eliminar correctamente"),CargarTablaElecciones(),CerrarCargando()):(alertaError("Eliminar datos",n.Mensaje),CerrarCargando())}})}function validarDatosEleccion(){return $.trim($("#nombre").val()).length<5?(alertaError("Datos Elección","El nombre debe ser mayor a 5 caracteres"),1):$.trim($("#descripcion").val()).length<10?(alertaError("Datos Elección","La descripción debe ser mayor a 9 caracteres"),1):$("#dtpRango").val().length<1?(alertaError("Datos Elección","Debe digitar un rango de fechas"),1):0}function GuardarModificarEleccion(n){n=="guardar"?GuardarEleccion():ModificarEleccion()}function CargarTablaEleccionesR(n){CargarFilasPR();DatosER.Id_eleccion=n;pidEleccionR="";PNombreEleccionR="";pidPapeletaC="";$("#tituloPapeletaR").text("Papeletas por ronda");MostrarCargando();$.ajax({type:"POST",url:apiUrl+"/api/Asamblea/EleccionRonda/ListadoEleccionesR",data:JSON.stringify(DatosER),contentType:"application/json; charset=utf-8",dataType:"JSON",error:function(n,t,i){mensajeError=n.status+"\n"+n.responseText;"\n"+i;alertaError("Listado elecciones",mensajeError);CerrarCargando()},success:function(n){CargarFilasR(n);CerrarCargando()}})}function CargarFilasR(n){var t=[];n!=null&&n!=undefined&&n.map(function(n){t.push([n.Id_ronda,n.Nombre,n.Descripcion,n.F_inicio,n.F_final,n.I_estado=="A"?"Activo":"Inactivo",'<img class="tooltipImgM" src="images/Iconos/update.png" style="cursor:pointer" data-toggle="tooltip" title="Modificar" />','<img class="tooltipImgB" src="images/Iconos/delete.png" style="cursor:pointer" data-toggle="tooltip" title="Eliminar" />'])});tablaER=objtablaER.DataTable({data:t,columns:[null,null,null,null,null,null,{width:"5%",sortable:!1,className:"textoCentrado"},{width:"5%",sortable:!1,className:"textoCentrado"}],paging:!0,lengthChange:!1,searching:!0,ordering:!0,info:!0,pageLength:20,autoWidth:!1,destroy:!0,deferRender:!0,scrollCollapse:!0,scroller:!0});tablaER.draw();$("#tablaEleccionR tbody").on("click","tr",function(){$(this).hasClass("selected")||(tablaER.$("tr.selected").removeClass("selected"),$(this).addClass("selected"))})}function GuardarEleccionR(){MostrarCargando();DatosER.Id_eleccion=pidEleccion;DatosER.Nombre=$("#nombreR").val();DatosER.Descripcion=$("#descripcionR").val();DatosER.F_inicio=$("#dtpRangoR").data("daterangepicker").startDate.format("DD/MM/YYYY hh:mm A").toString();DatosER.F_final=$("#dtpRangoR").data("daterangepicker").endDate.format("DD/MM/YYYY hh:mm A").toString();DatosER.Usuario=sessionStorage.Cedula;DatosER.I_estado=$("#chkactivoR").is(":checked")?"A":"I";$.ajax({type:"POST",url:apiUrl+"/api/Asamblea/EleccionRonda/InsertarEleccionR",data:JSON.stringify(DatosER),contentType:"application/json; charset=utf-8",dataType:"JSON",headers:{Auth:sessionStorage.Cedula+":"+sessionStorage.Token},error:function(n,t,i){mensajeError=n.status+"\n"+n.responseText;"\n"+i;alertaError("Guardar datos ronda",mensajeError);CerrarCargando()},success:function(n){n.Error=="0"?(alertaExito("Guardar datos ronda","Datos Guardados correctamente"),CargarTablaEleccionesR(pidEleccion),CerrarCargando()):(alertaError("Guardar datos ronda",n.Mensaje),CerrarCargando())}})}function ModificarEleccionR(){MostrarCargando();DatosER.Id_eleccion=pidEleccion;DatosER.Id_ronda=$("#idR").val();DatosER.Nombre=$("#nombreR").val();DatosER.Descripcion=$("#descripcionR").val();DatosER.F_inicio=$("#dtpRangoR").data("daterangepicker").startDate.format("DD/MM/YYYY hh:mm A").toString();DatosER.F_final=$("#dtpRangoR").data("daterangepicker").endDate.format("DD/MM/YYYY hh:mm A").toString();DatosER.Usuario=sessionStorage.Cedula;DatosER.I_estado=$("#chkactivoR").is(":checked")?"A":"I";$.ajax({type:"POST",url:apiUrl+"/api/Asamblea/EleccionRonda/ActualizarEleccionR",data:JSON.stringify(DatosER),contentType:"application/json; charset=utf-8",dataType:"JSON",headers:{Auth:sessionStorage.Cedula+":"+sessionStorage.Token},error:function(n,t,i){mensajeError=n.status+"\n"+n.responseText;"\n"+i;alertaError("Guardar datos",mensajeError);CerrarCargando()},success:function(n){n.Error=="0"?(alertaExito("Guardar datos ronda","Datos Modificados correctamente"),CargarTablaEleccionesR(pidEleccion),CerrarCargando()):(alertaError("Guardar datos ronda",n.Mensaje),CerrarCargando())}})}function EliminarEleccionR(n){MostrarCargando();DatosER.Id_eleccion=pidEleccion;DatosER.Id_ronda=n;DatosER.Nombre="";DatosER.Descripcion="";DatosER.F_inicio="";DatosER.F_final="";DatosER.User_modifica="";DatosER.I_estado="";$.ajax({type:"POST",url:apiUrl+"/api/Asamblea/EleccionRonda/EliminarEleccionR",data:JSON.stringify(DatosER),contentType:"application/json; charset=utf-8",dataType:"JSON",headers:{Auth:sessionStorage.Cedula+":"+sessionStorage.Token},error:function(n,t,i){mensajeError=n.status+"\n"+n.responseText;"\n"+i;alertaError("Eliminar datos ronda",mensajeError);CerrarCargando()},success:function(n){n.Error=="0"?(alertaExito("Eliminar datos ronda","Datos Eliminar correctamente"),CargarTablaEleccionesR(pidEleccion),CerrarCargando()):(alertaError("Eliminar datos ronda",n.Mensaje),CerrarCargando())}})}function validarDatosEleccionR(){return $.trim($("#nombreR").val()).length<5?(alertaError("Datos ronda elección","El nombre debe ser mayor a 5 caracteres"),1):$.trim($("#descripcionR").val()).length<10?(alertaError("Datos ronda elección","La descripción debe ser mayor a 9 caracteres"),1):$("#dtpRangoR").val().length<1?(alertaError("Datos ronda elección","Debe digitar un rango de fechas"),1):0}function GuardarModificarEleccionR(n){n=="guardar"?GuardarEleccionR():ModificarEleccionR()}function CargarTablaEleccionesPR(n,t){DatosPR.Id_eleccion=n;DatosPR.Id_ronda=t;pidPapeletaC="";MostrarCargando();$.ajax({type:"POST",url:apiUrl+"/api/Asamblea/PapeletaRonda/ListadoPapeletasR",data:JSON.stringify(DatosPR),contentType:"application/json; charset=utf-8",dataType:"JSON",error:function(n,t,i){mensajeError=n.status+"\n"+n.responseText;"\n"+i;alertaError("Listado papeletas por ronda",mensajeError);CerrarCargando()},success:function(n){CargarFilasPR(n);CerrarCargando()}})}function CargarFilasPR(n){var t=[];n!=null&&n!=undefined&&n.map(function(n){t.push([n.Id_papeleta,n.Nombre,n.Descripcion,n.Num_votos,n.Orden,n.I_estado=="A"?"Activo":"Inactivo",'<img class="tooltipImgR" src="images/Iconos/reset.png" style="cursor:pointer" data-toggle="tooltip" title="Regenerar posiciones" />','<img class="tooltipImgC" src="images/Iconos/candidatos.png" style="cursor:pointer" data-toggle="tooltip" title="Candidatos" />','<img class="tooltipImgM" src="images/Iconos/update.png" style="cursor:pointer" data-toggle="tooltip" title="Modificar" />','<img class="tooltipImgB" src="images/Iconos/delete.png" style="cursor:pointer" data-toggle="tooltip" title="Eliminar" />'])});tablaPR=objtablaPR.DataTable({data:t,columns:[null,null,null,null,null,null,{width:"5%",sortable:!1,className:"textoCentrado"},{width:"5%",sortable:!1,className:"textoCentrado"},{width:"5%",sortable:!1,className:"textoCentrado"},{width:"5%",sortable:!1,className:"textoCentrado"}],paging:!0,lengthChange:!1,searching:!0,ordering:!0,info:!0,pageLength:20,autoWidth:!1,destroy:!0,deferRender:!0,scrollCollapse:!0,scroller:!0});tablaER.draw();$("#tablaEleccionPR tbody").on("click","tr",function(){$(this).hasClass("selected")||(tablaPR.$("tr.selected").removeClass("selected"),$(this).addClass("selected"))})}function GuardarEleccionPR(){MostrarCargando();DatosPR.Id_eleccion=pidEleccion;DatosPR.Id_ronda=pidEleccionR;DatosPR.Id_papeleta=$("#selPapeleta").val();DatosPR.Descripcion=$("#descripcionPR").val();DatosPR.Num_votos=$("#numVotos").val();DatosPR.Orden=$("#orden").val();DatosPR.Usuario=sessionStorage.Cedula;DatosPR.I_estado=$("#chkactivoPR").is(":checked")?"A":"I";$.ajax({type:"POST",url:apiUrl+"/api/Asamblea/PapeletaRonda/InsertarPapeletaR",data:JSON.stringify(DatosPR),contentType:"application/json; charset=utf-8",dataType:"JSON",headers:{Auth:sessionStorage.Cedula+":"+sessionStorage.Token},error:function(n,t,i){mensajeError=n.status+"\n"+n.responseText;"\n"+i;alertaError("Guardar datos papeletas ronda",mensajeError);CerrarCargando()},success:function(n){n.Error=="0"?(alertaExito("Guardar datos papeletas ronda","Datos Guardados correctamente"),CargarTablaEleccionesPR(pidEleccion,pidEleccionR),CerrarCargando()):(alertaError("Guardar datos papeletas ronda",n.Mensaje),CerrarCargando())}})}function ModificarEleccionPR(){MostrarCargando();DatosPR.Id_eleccion=pidEleccion;DatosPR.Id_ronda=pidEleccionR;DatosPR.Id_papeleta=$("#selPapeleta").val();DatosPR.Descripcion=$("#descripcionPR").val();DatosPR.Num_votos=$("#numVotos").val();DatosPR.Orden=$("#orden").val();DatosPR.Usuario=sessionStorage.Cedula;DatosPR.I_estado=$("#chkactivoPR").is(":checked")?"A":"I";$.ajax({type:"POST",url:apiUrl+"/api/Asamblea/PapeletaRonda/ActualizarPapeletaR",data:JSON.stringify(DatosPR),contentType:"application/json; charset=utf-8",dataType:"JSON",headers:{Auth:sessionStorage.Cedula+":"+sessionStorage.Token},error:function(n,t,i){mensajeError=n.status+"\n"+n.responseText;"\n"+i;alertaError("Guardar datos ronda papeleta",mensajeError);CerrarCargando()},success:function(n){n.Error=="0"?(alertaExito("Guardar datos ronda papeleta","Datos Modificados correctamente"),CargarTablaEleccionesPR(pidEleccion,pidEleccionR),CerrarCargando()):(alertaError("Guardar datos ronda papeleta",n.Mensaje),CerrarCargando())}})}function EliminarEleccionPR(n){MostrarCargando();DatosPR.Id_eleccion=pidEleccion;DatosPR.Id_ronda=pidEleccionR;DatosPR.Id_papeleta=n;DatosPR.Descripcion="";DatosPR.Num_votos=0;DatosPR.Orden=0;DatosPR.Usuario="";DatosPR.I_estado="";$.ajax({type:"POST",url:apiUrl+"/api/Asamblea/PapeletaRonda/EliminarPapeletaR",data:JSON.stringify(DatosPR),contentType:"application/json; charset=utf-8",dataType:"JSON",headers:{Auth:sessionStorage.Cedula+":"+sessionStorage.Token},error:function(n,t,i){mensajeError=n.status+"\n"+n.responseText;"\n"+i;alertaError("Eliminar ronda papeleta",mensajeError);CerrarCargando()},success:function(n){n.Error=="0"?(alertaExito("Eliminar datos ronda papeleta","Datos Eliminados correctamente"),CargarTablaEleccionesPR(pidEleccion,pidEleccionR),CerrarCargando()):(alertaError("Eliminar datos ronda papeleta",n.Mensaje),CerrarCargando())}})}function validarDatosEleccionPR(){return $.trim($("#descripcionPR").val()).length<5?(alertaError("Datos papelta ronda","La descripción debe ser mayor a 9 caracteres"),1):$("#numVotos").val()<=0?(alertaError("Datos papelta ronda","El número de votos debe ser mayor a 0."),1):$("#orden").val()<=0?(alertaError("Datos papelta ronda","El orden debe ser mayor a 0."),1):0}function GuardarModificarEleccionPR(n){n=="guardar"?GuardarEleccionPR():ModificarEleccionPR()}function CargarTablaCandidatos(n,t,i){DatosPC.Id_eleccion=n;DatosPC.Id_ronda=t;DatosPC.Id_papeleta=i;MostrarCargando();$.ajax({type:"POST",url:apiUrl+"/api/Asamblea/PapeletaCandidato/ListadoCandidatosS",data:JSON.stringify(DatosPC),contentType:"application/json; charset=utf-8",dataType:"JSON",error:function(n,t,i){mensajeError=n.status+"\n"+n.responseText;"\n"+i;alertaError("Listado candidatos por papeleta",mensajeError);CerrarCargando()},success:function(n){CargarFilasCandidatos(n);CerrarCargando()}})}function CargarTablaCandidatosT(n,t,i){DatosPC.Id_eleccion=n;DatosPC.Id_ronda=t;DatosPC.Id_papeleta=i;MostrarCargando();$.ajax({type:"POST",url:apiUrl+"/api/Asamblea/PapeletaCandidato/ListadoCandidatos",data:JSON.stringify(DatosPC),contentType:"application/json; charset=utf-8",dataType:"JSON",error:function(n,t,i){mensajeError=n.status+"\n"+n.responseText;"\n"+i;alertaError("Listado candidatos por papeleta",mensajeError);CerrarCargando()},success:function(n){CargarFilasCandidatos(n);CerrarCargando()}})}function CargarFilasCandidatos(n){var t=[];n!=null&&n!=undefined&&n.map(function(n){t.push([n.I_estado==null||n.I_estado=="I"?'<input type="checkbox" />':'<input type="checkbox" checked />',n.Id_candidato,n.Cedula,n.Nombre])});tablaPC=objtablaPC.DataTable({data:t,columns:[{width:"10%",sortable:!1,className:"textoCentrado"},null,null,null],drawCallback:function(){$("#tablaPapeletaC input:checkbox:checked").map(function(){$(this).closest("tr").addClass("selected")})},order:[],paging:!0,lengthChange:!1,searching:!0,ordering:!0,info:!0,pageLength:10,autoWidth:!1,destroy:!0,deferRender:!0,scrollCollapse:!0,scroller:!0});tablaPC.draw()}function GuardarCandidato(n,t,i,r){MostrarCargando();DatosPC.Id_eleccion=pidEleccion;DatosPC.Id_ronda=pidEleccionR;DatosPC.Id_papeleta=pidPapeletaC;DatosPC.Id_candidato=n;DatosPC.Descripcion=t;DatosPC.Num_posicion=null;DatosPC.I_estado="A";DatosPC.Usuario=sessionStorage.Cedula;$.ajax({type:"POST",url:apiUrl+"/api/Asamblea/PapeletaCandidato/InsertarPapeletaC",data:JSON.stringify(DatosPC),contentType:"application/json; charset=utf-8",dataType:"JSON",headers:{Auth:sessionStorage.Cedula+":"+sessionStorage.Token},error:function(n,t,i){r.prop("checked",!1);mensajeError=n.status+"\n"+n.responseText;"\n"+i;alertaError("Guardar datos candidato",mensajeError);CerrarCargando()},success:function(n){n.Error=="0"?(i.addClass("selected"),CerrarCargando()):(r.prop("checked",!1),alertaError("Guardar datos papeletas ronda",n.Mensaje),CerrarCargando())}})}function EliminarCandidato(n,t,i,r){MostrarCargando();DatosPC.Id_eleccion=pidEleccion;DatosPC.Id_ronda=pidEleccionR;DatosPC.Id_papeleta=pidPapeletaC;DatosPC.Id_candidato=n;DatosPC.Descripcion=t;DatosPC.Num_posicion=null;DatosPC.I_estado="A";DatosPC.Usuario=sessionStorage.Cedula;$.ajax({type:"POST",url:apiUrl+"/api/Asamblea/PapeletaCandidato/EliminarPapeletaC",data:JSON.stringify(DatosPC),contentType:"application/json; charset=utf-8",dataType:"JSON",headers:{Auth:sessionStorage.Cedula+":"+sessionStorage.Token},error:function(n,t,i){mensajeError=n.status+"\n"+n.responseText;"\n"+i;alertaError("Guardar datos candidato",mensajeError);CerrarCargando();r.prop("checked",!0)},success:function(n){n.Error=="0"?(i.removeClass("selected"),CerrarCargando()):(alertaError("Guardar datos papeletas ronda",n.Mensaje),r.prop("checked",!0),CerrarCargando())}})}function GenerarPosiciones(n,t,i){MostrarCargando();DatosPC.Id_eleccion=pidEleccion;DatosPC.Id_ronda=t;DatosPC.Id_papeleta=i;$.ajax({type:"POST",url:apiUrl+"/api/Asamblea/PapeletaCandidato/ActualizarPapeletaPos",data:JSON.stringify(DatosPC),contentType:"application/json; charset=utf-8",dataType:"JSON",headers:{Auth:sessionStorage.Cedula+":"+sessionStorage.Token},error:function(n,t,i){mensajeError=n.status+"\n"+n.responseText;"\n"+i;alertaError("Asignar posiciones",mensajeError);CerrarCargando()},success:function(n){n.Error=="0"?(alertaExito("Asignar posiciones","Posiciones asignadas correctamente"),CerrarCargando()):(alertaError("Asignar posiciones",n.Mensaje),CerrarCargando())}})}var pidEleccion="",pNombreEleccion="",pidEleccionR="",PNombreEleccionR="",pidPapeletaC="",apiUrl=sessionStorage.Uri,objtablaE=$("#tablaEleccion"),tablaE,objtablaER=$("#tablaEleccionR"),tablaER,objtablaPR=$("#tablaEleccionPR"),tablaPR,objtablaPC=$("#tablaPapeletaC"),tablaPC,nombreReporte="Lista de Elecciones",DatosE={Id_eleccion:"",Nombre:"",Descripcion:"",F_inicio:"",F_final:"",I_estado:"",I_cierre_quorum:"",Usuario:"",Terminal:""},DatosER={Id_eleccion:"",Id_ronda:"",Nombre:"",Descripcion:"",F_inicio:"",F_final:"",I_estado:"",Usuario:"",Terminal:""},DatosPR={Id_eleccion:"",Id_ronda:"",Id_papeleta:"",Nombre:"",Descripcion:"",Num_votos:0,Orden:0,I_estado:"",Usuario:"",Terminal:""},DatosPC={Id_eleccion:"",Id_ronda:"",Id_papeleta:"",Id_candidato:"",Num_posicion:0,Cedula:"",Nombre:"",Foto:"",Descripcion:"",I_estado:"",Usuario:"",Terminal:""};$(document).ready(function(){CargarTablaElecciones();obtenerPapeletas();$(".toggle").width(150);$("#chkTipo").change(function(){$(this).is(":checked")?CargarTablaCandidatos(pidEleccion,pidEleccionR,pidPapeletaC):CargarTablaCandidatosT(pidEleccion,pidEleccionR,pidPapeletaC)});$("#dtpRango, #dtpRangoR").daterangepicker({timePicker:!0,timePickerIncrement:30,locale:{format:"DD/MM/YYYY hh:mm A"}});$(document).on("click","#btnAgregar",function(){$("#modal-lg-eleccion").data("tipo","guardar");$("#modal-lg-eleccion").modal("show");$("#lblEleccion").text("Nueva Elección");$("#id").val("0");$("#nombre").val("");$("#descripcion").val("");$("#chkactivo").prop("checked",!0).change();$("#chquorum").prop("checked",!1).change()});$(document).on("click","#tablaEleccion .tooltipImgM",function(){var n=$(this).closest("tr").find("td:eq(0)").text(),t=$(this).closest("tr").find("td:eq(1)").text(),i=$(this).closest("tr").find("td:eq(2)").text(),r=$(this).closest("tr").find("td:eq(3)").text(),u=$(this).closest("tr").find("td:eq(4)").text(),f=$(this).closest("tr").find("td:eq(5)").text(),e=$(this).closest("tr").find("td:eq(6)").text();$("#modal-lg-eleccion").data("tipo","modificar");$("#modal-lg-eleccion").modal("show");$("#lblEleccion").text("Modificar Elección");$("#id").val(n);$("#nombre").val(t);$("#descripcion").val(i);$("#dtpRango").data("daterangepicker").setStartDate(r);$("#dtpRango").data("daterangepicker").setEndDate(u);f=="Activo"?$("#chkactivo").prop("checked",!0).change():$("#chkactivo").prop("checked",!1).change();e=="Si"?$("#chkquorum").prop("checked",!0).change():$("#chkquorum").prop("checked",!1).change()});$(document).on("click","#tablaEleccion .tooltipImgB",function(){var n=$(this).closest("tr").find("td:eq(0)").text();Swal.close();Swal.fire({title:"Eliminar Datos",text:"¿Desea Eliminar la elección seleccionada?",type:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",cancelButtonText:"Cancelar",confirmButtonText:"Aceptar"}).then(function(t){t.value&&EliminarEleccion(n)})});$(document).on("click","#btnGuardar",function(){validarDatosEleccion()!=1&&(Swal.close(),Swal.fire({title:"Guardar Datos",text:"¿Desea guardar los datos?",type:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",cancelButtonText:"Cancelar",confirmButtonText:"Aceptar"}).then(function(n){n.value&&($("#modal-lg-eleccion").modal("hide"),GuardarModificarEleccion($("#modal-lg-eleccion").data("tipo")))}))});$(document).on("click","#tablaEleccion .selected",function(){var n=$(this).find("td:eq(0)").text();pidEleccion=n;pNombreEleccion=$(this).find("td:eq(1)").text();pidEleccionR="";PNombreEleccionR="";pidPapeletaC="";$("#tituloRondaE").text("Rondas para la elección "+n+" - "+pNombreEleccion);CargarTablaEleccionesR(n)});$(document).on("click","#btnAgregarR",function(){if(pidEleccion==""||pidEleccion==null||pidEleccion==undefined){alertaError("Nueva Ronda","Debe seleccionar una elección para poder crear una ronda de elección.");return}$("#modal-lg-eleccionR").data("tipo","guardar");$("#modal-lg-eleccionR").modal("show");$("#lblEleccionR").text("Nueva Ronda de Elección");$("#idR").val("0");$("#nombreR").val("");$("#descripcionR").val("");$("#chkactivoR").prop("checked",!0).change()});$(document).on("click","#tablaEleccionR .tooltipImgM",function(){var n=$(this).closest("tr").find("td:eq(0)").text(),t=$(this).closest("tr").find("td:eq(1)").text(),i=$(this).closest("tr").find("td:eq(2)").text(),r=$(this).closest("tr").find("td:eq(3)").text(),u=$(this).closest("tr").find("td:eq(4)").text(),f=$(this).closest("tr").find("td:eq(5)").text();$("#modal-lg-eleccionR").data("tipo","modificar");$("#modal-lg-eleccionR").modal("show");$("#lblEleccionR").text("Modificar Ronda de Elección");$("#idR").val(n);$("#nombreR").val(t);$("#descripcionR").val(i);$("#dtpRangoR").data("daterangepicker").setStartDate(r);$("#dtpRangoR").data("daterangepicker").setEndDate(u);f=="Activo"?$("#chkactivoR").prop("checked",!0).change():$("#chkactivoR").prop("checked",!1).change()});$(document).on("click","#tablaEleccionR .tooltipImgB",function(){var n=$(this).closest("tr").find("td:eq(0)").text();Swal.close();Swal.fire({title:"Eliminar Datos",text:"¿Desea Eliminar la ronda de elección seleccionada?",type:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",cancelButtonText:"Cancelar",confirmButtonText:"Aceptar"}).then(function(t){t.value&&EliminarEleccionR(n)})});$(document).on("click","#btnGuardarR",function(){validarDatosEleccionR()!=1&&(Swal.close(),Swal.fire({title:"Guardar Datos",text:"¿Desea guardar los datos?",type:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",cancelButtonText:"Cancelar",confirmButtonText:"Aceptar"}).then(function(n){n.value&&($("#modal-lg-eleccionR").modal("hide"),GuardarModificarEleccionR($("#modal-lg-eleccionR").data("tipo")))}))});$(document).on("click","#tablaEleccionR .selected",function(){var n=$(this).find("td:eq(0)").text();if(pidEleccionR=n,PNombreEleccionR=$(this).find("td:eq(1)").text(),pidEleccionR=="Ningún dato disponible en esta tabla"){pidEleccionR="";PNombreEleccionR="";return}pidPapeletaC="";$("#tituloPapeletaR").text("Papeletas para la ronda "+pidEleccionR+" - "+PNombreEleccionR);CargarTablaEleccionesPR(pidEleccion,pidEleccionR)});$(document).on("click","#btnAgregarPR",function(){if(pidEleccion==""||pidEleccion==null||pidEleccion==undefined||pidEleccionR==""||pidEleccionR==null||pidEleccionR==undefined){alertaError("Nueva papeleta","Debe seleccionar una elección y una ronda para poder crear una papeleta.");return}$("#modal-lg-papeletaR").data("tipo","guardar");$("#modal-lg-papeletaR").modal("show");$("#lblpapeletaR").text("Nueva Papeleta");$("#selPapeleta").val(1);$("#descripcionPR").val("");$("#numVotos").val(0);$("#orden").val(0);$("#chkactivoPR").prop("checked",!0).change()});$(document).on("click","#tablaEleccionPR .tooltipImgM",function(){var n=$(this).closest("tr").find("td:eq(0)").text(),t=$(this).closest("tr").find("td:eq(2)").text(),i=$(this).closest("tr").find("td:eq(3)").text(),r=$(this).closest("tr").find("td:eq(4)").text(),u=$(this).closest("tr").find("td:eq(5)").text();$("#modal-lg-papeletaR").data("tipo","modificar");$("#modal-lg-papeletaR").modal("show");$("#lblpapeletaR").text("Modificar Papeleta");$("#selPapeleta").val(n);$("#descripcionPR").val(t);$("#numVotos").val(i);$("#orden").val(r);u=="Activo"?$("#chkactivoPR").prop("checked",!0).change():$("#chkactivoPR").prop("checked",!1).change()});$(document).on("click","#tablaEleccionPR .tooltipImgB",function(){var n=$(this).closest("tr").find("td:eq(0)").text();Swal.close();Swal.fire({title:"Eliminar Datos",text:"¿Desea Eliminar la papeleta de la ronda?",type:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",cancelButtonText:"Cancelar",confirmButtonText:"Aceptar"}).then(function(t){t.value&&EliminarEleccionPR(n)})});$(document).on("click","#tablaEleccionPR .tooltipImgR",function(){var n=$(this).closest("tr").find("td:eq(0)").text();Swal.fire({title:"Regenerar posiciones",text:"¿Desea generar las posiciones de los candidatos en la papeleta?",type:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",cancelButtonText:"Cancelar",confirmButtonText:"Aceptar"}).then(function(t){t.value&&GenerarPosiciones(pidEleccion,pidEleccionR,n)})});$(document).on("click","#btnGuardarPR",function(){validarDatosEleccionPR()!=1&&(Swal.close(),Swal.fire({title:"Guardar Datos",text:"¿Desea guardar los datos?",type:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",cancelButtonText:"Cancelar",confirmButtonText:"Aceptar"}).then(function(n){n.value&&($("#modal-lg-papeletaR").modal("hide"),GuardarModificarEleccionPR($("#modal-lg-papeletaR").data("tipo")))}))});$(document).on("click","#tablaEleccionPR .tooltipImgC",function(){pidPapeletaC=$(this).closest("tr").find("td:eq(0)").text();var n=$(this).closest("tr").find("td:eq(1)").text();$("#chkTipo").prop("checked",!0);$(".toggle").removeClass("btn-danger");$(".toggle").removeClass("off");$(".toggle").addClass("btn-success");$("#modal-lg-papeletaC").data("tipo","modificar");$("#modal-lg-papeletaC").modal("show");$("#lblpapeletaC").text("Candidatos papeleta "+n);CargarTablaCandidatos(pidEleccion,pidEleccionR,pidPapeletaC)});$(document).on("click","#tablaPapeletaC input[type=checkbox]",function(){var n=$(this).closest("tr").find("td:eq(1)").text(),t=$(this).closest("tr").find("td:eq(2)").text();$(this).is(":checked")?GuardarCandidato(n,t,$(this).closest("tr"),$(this)):EliminarCandidato(n,t,$(this).closest("tr"),$(this))})});