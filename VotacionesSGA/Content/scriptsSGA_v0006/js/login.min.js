function validar(){if($("#username").val().trim()===""){alertaError("LOGIN","Debe digitar su USUARIO.");return}if($("#pin").val().trim()===""||$("#pin").val().trim().length<4){alertaError("LOGIN","Debe digitar una CLAVE de entre 4 y 6 valores.");return}validarUsuario()}function validarUsuario(){var n=get_browser_info();MostrarCargando();DatosU.Login=$("#username").val().trim().toUpperCase();DatosU.Clave=$("#pin").val().trim().toUpperCase();DatosU.Navegador=n.name+" - "+n.version;$.ajax({type:"POST",url:"http://localhost:8086/api/login/Usuario/ValidarUsuario",data:JSON.stringify(DatosU),contentType:"application/json; charset=utf-8",dataType:"JSON",error:function(n,t,i){mensajeError=n.status+"\n"+n.responseText;"\n"+i;alertaError("VOTACIONES SGA",mensajeError);CerrarCargando()},success:function(n){n.respuesta>0?IngresarSistema(n.ObjUsuario):n.respuesta===-1?(alertaError("VOTACIONES SGA","El usuario o clave son incorrectos."),CerrarCargando()):n.respuesta===-2?(alertaError("VOTACIONES SGA","El usuario está Inactivo."),CerrarCargando()):n.respuesta===-3?(ToastGlobal.fire({toast:!1,type:"info",title:"VOTACIONES SGA",html:'<h3>El usuario <a class="text-danger">'+DatosU.Login+"<\/a> ya emitió su voto.<\/h3><\/br>",allowOutsideClick:!0,timer:7e3}),CerrarCargando()):(alertaError("VOTACIONES SGA","Ocurrio un error no controlado."+n.respuesta),CerrarCargando())}})}function IngresarSistema(n){sessionStorage.Id=n.Id_usuario;sessionStorage.Id_delegado=n.Id_delegado;sessionStorage.Cedula=n.Login;sessionStorage.Nombre=n.Nombre;sessionStorage.Foto=n.Foto;sessionStorage.Token=n.Token;sessionStorage.Rol=n.Id_rol;sessionStorage.F_ult_ingreso=n.F_ult_ingreso;sessionStorage.Uri="http://localhost:8086";sessionStorage.Pagina_ref=n.Pagina_ref;sessionStorage.Sesion_act=n.Sesion_act;sessionStorage.getItem("Pagina_ref")===""?(ToastGlobal.fire({toast:!1,type:"info",title:"VOTACIONES SGA",html:'<h3>El Rol ( <a class="text-danger bold">'+n.Id_rol+" - "+n.Nombre_rol+"<\/a> ) del usuario <b>"+n.Login+"<\/b> no tiene una página inicial definida.<\/h3><\/br>",allowOutsideClick:!0,timer:7e3}),CerrarCargando()):redirect(sessionStorage.getItem("Pagina_ref"))}function MostrarCargando(){$("body").append('<div id="loading"><div id="cargando" class="spinner"><\/div><\/div>');$("#loading").show()}function CerrarCargando(){$("#loading").hide();$("#loading").remove()}function get_browser_info(){var i=navigator.userAgent,t,n=i.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(n[1])?(t=/\brv[ :]+(\d+)/g.exec(i)||[],{name:"IE ",version:t[1]||""}):n[1]==="Chrome"&&(t=i.match(/\bOPR\/(\d+)/),t!==null)?{name:"Opera",version:t[1]}:(n=n[2]?[n[1],n[2]]:[navigator.appName,navigator.appVersion,"-?"],(t=i.match(/version\/(\d+)/i))!==null&&n.splice(1,1,t[1]),{name:n[0],version:n[1]})}function redirect(n){var i=navigator.userAgent.toLowerCase(),r=i.indexOf("msie")!==-1,u=parseInt(i.substr(4,2),10),t;r&&u<9?(t=document.createElement("a"),t.href=n,document.body.appendChild(t),t.click()):window.location.href=n}function alertaError(n,t){Swal.close();Swal.fire({type:"error",title:n,text:t,timer:15e3,confirmButtonText:"Aceptar"})}const ToastGlobal=Swal.mixin({position:"center",showConfirmButton:!1});var DatosU={};$(document).ready(function(){sessionStorage.clear();$("#btnlogin").click(function(n){n.preventDefault();validar()});$("#pin, #username").keypress(function(n){var t=n.which;t===13&&validar()})});