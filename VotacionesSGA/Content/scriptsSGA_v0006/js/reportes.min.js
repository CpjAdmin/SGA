function iniciarDataTable(n){tabla=objTabla.DataTable({dom:"Bfrtip",buttons:[{extend:"excelHtml5",text:"EXCEL",exportOptions:{columns:[0,1,2,3,4,5,6,7,8],stripHtml:!1},title:"Lista de Reportes",sheetName:"Reportes",className:"btn-success mr-2"}],fnDrawCallback:function(){var n=objTabla.DataTable();n.data().length===0?n.buttons(".buttons-html5").disable():n.buttons(".buttons-html5").enable()},initComplete:function(){$(".dataTables_scrollBody thead tr").css({visibility:"collapse"})},bDestroy:!0,bDeferRender:!0,paging:!1,scrollY:$(document).height()-380+"px",scrollCollapse:!0,scroller:!0,bSort:!0,autoWidth:!0,responsive:!0,aoColumns:[{className:"text-center text-danger text-bold"},{className:"text-center",width:"8%"},{width:"12%"},{width:"12%"},{width:"18%"},null,null,{className:"text-center"},{className:"text-center",width:"7%"},{className:"text-center",sortable:!1,width:"5%"}]});setTimeout(function(){n()},500)}function obtenerReportes(){var n={},t;n.Usuario=Login;t=JSON.stringify({parametros:n});$.ajax({type:"POST",url:apiUrl+"/api/Reportes/ListaReportes",data:t,async:!0,contentType:"application/json; charset=utf-8",dataType:"JSON",error:function(n,t,i){mensajeError=n.status+"\n"+n.responseText;"\n"+i;alertaError("Carga de Reportes",mensajeError)},success:function(n){if(n.length===0)Toast.fire({toast:!1,type:"info",title:"CARGA DE REPORTES",html:"<h5>No existen reportes en la base de datos<\/h5>",allowOutsideClick:!0,confirmButtonColor:"#3085d6",confirmButtonText:"Aceptar"}).then(function(){});else{var t=n.length;$(".card-titulo").html('<i class="fas fa-square text-success mr-2"><\/i><b>REPORTES DEL SISTEMA  ( TOTAL : <\/b> <b style="font-size: 20px;" class="text-danger ml-2">'+t+"<\/b> )");agregarFilasDT(n)}}})}function agregarFilasDT(n){var i,t,r;for(objTabla.dataTable().fnClearTable(),i=[],t=0;t<n.length;t++)i.push([n[t].Id_reporte,n[t].Cod_alterno,n[t].Nombre,n[t].Archivo_rpt,n[t].Ubicacion_ssrs,n[t].Descripcion,n[t].Parametros,spanEstado(n[t].I_estado),n[t].Id_modulo,validarEjecutar(n[t].I_estado,n[t].Id_reporte)]);if(objTabla.dataTable().fnAddData(i,!1),tabla.draw(),$("#btnRefrescar").length===0){r='<button type="button" class="btn  bg-gradient-secondary" id="btnRefrescar" style="margin-left:8px;">Refrescar<\/button>';$(".buttons-excel").after(r);$(document).on("click","#btnRefrescar",function(){location.reload(!0)})}}function spanEstado(n){var t=n==="A"?"ACTIVO":"INACTIVO";switch(t){case"ACTIVO":return'<small class="badge badge-success">'+t+"<\/small>";case"INACTIVO":return'<small class="badge badge-danger">'+t+"<\/small>";default:return'<small class="badge badge-info">'+t+"<\/small>"}}function validarEjecutar(n,t){switch(n){case"A":return"<img id="+t+' class="tooltipImgM dt-fondo-circular-verde" src="images/Iconos/send.png" style="cursor:pointer" data-toggle="tooltip" title="Ejecutar Reporte" />';case"I":return'<span class="fa fa-lock text-danger" title="Reporte Bloqueado"><\/span>';default:return""}}const Toast=Swal.mixin({position:"center"});var tabla,dataReportes,objTabla=$("#tbl_tabla"),refresh_Interval_TablaId,apiUrl=sessionStorage.Uri,Login,auxReporte=null,parametrosAux=[],reporteEjecutado=null,DatosER={Id_eleccion:"",Id_ronda:"",Nombre:"",Descripcion:"",F_inicio:"",F_final:"",I_estado:"",Usuario:"",Terminal:""};$(document).ready(function(){Login=sessionStorage.getItem("Cedula");iniciarDataTable(obtenerReportes);$(document).on("click",".tooltipImgM",function(){var n=$(this).closest("tr").find("td:eq(3)").text(),t=$(this).closest("tr").find("td:eq(4)").text();window.open("ReportViewer.aspx?urpt="+Login+"&nrpt="+n+"&irpt="+t,"_blank")})});